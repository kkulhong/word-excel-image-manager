# 통합 Word-Excel 이미지 관리 프로그램

Word 문서와 Excel 파일을 자동으로 처리하는 통합 GUI 애플리케이션입니다.

## 주요 기능

### Tab 1: 이미지 파일명 관리
1. **파일명 기입**: Word 문서 표에 이미지 파일명 자동 삽입
2. **이미지 삽입**: 파일명과 매칭되는 이미지 자동 삽입 (BE 테스트 자동 감지)
3. **테이블 자동 생성**: 이미지 목록으로 2열 테이블 생성

### Tab 2: Excel 범위 삽입
- Excel 범위를 이미지로 변환하여 Word 문서의 마커 위치에 자동 삽입
- 다중 파일 동시 처리 지원
- 설정 파일 관리 (range_config.xlsx)

## 기술 스택

- **Python 3.x**
- **PySide6** (Qt for Python) - GUI 프레임워크
- **python-docx** - Word 문서 처리
- **Pillow (PIL)** - 이미지 처리
- **win32com** - Excel COM 객체 제어
- **openpyxl** - Excel 파일 읽기/쓰기

## 설치 방법

```bash
pip install PySide6 python-docx Pillow pywin32 openpyxl
```

## 실행 방법

```bash
python integrated_word_excel_manager.py
```

## 특징

- ✅ **심플하고 직관적인 GUI**: 탭 기반 인터페이스
- ✅ **멀티스레딩**: 백그라운드 작업으로 UI 반응성 유지
- ✅ **스레드 안전성**: Qt 스레드 안전 규칙 준수
- ✅ **실시간 로그**: 작업 진행 상황 실시간 표시
- ✅ **에러 처리**: 상세한 에러 메시지 및 복구 로직
- ✅ **백업 생성**: 원본 파일 안전 보호 (_copy 자동 생성)
- ✅ **한글 주석**: 중요 코드에 한글 설명 포함

## 프로젝트 구조

```
Report/
├── integrated_word_excel_manager.py  # 통합 메인 프로그램
├── report.py                         # 원본: 이미지 파일명 관리
├── excel_to_word_gui.py              # 원본: Excel 범위 삽입
├── range_config.xlsx                 # Excel 범위 설정 파일
└── backup/                           # 원본 파일 백업 폴더
```

## 사용 가이드

### Tab 1: 이미지 파일명 관리

#### 기능 1 - 파일명 기입
1. 이미지 폴더 선택
2. Word 문서 선택
3. "1. 파일명 기입" 버튼 클릭

#### 기능 2 - 이미지 삽입 (통합)
1. 이미지 폴더 선택
2. Word 문서 선택 (표 포함)
3. "2. 이미지 삽입" 버튼 클릭
   - 파일명과 매칭되는 이미지 자동 삽입
   - BE 테스트 셀 자동 감지 및 처리 (OFDM/DFT-s)

#### 기능 3 - 테이블 자동 생성
1. 이미지 폴더 선택
2. "3. 테이블 자동 생성" 버튼 클릭
   - 새 Word 문서에 2열 테이블 생성

💡 **팁**:
- 하위폴더 포함 체크 시 모든 서브폴더 검색
- BE 테스트: OFDM/DFT-s 자동 인식
- 원본 파일 자동 백업 (_copy 생성)

### Tab 2: Excel 범위 삽입

#### 기본 사용
1. Excel 파일 선택 (여러 개 가능)
2. Word 파일 선택 (여러 개 가능)
3. 접미사 확인 (#1, #2 등)
4. "▶ 실행" 버튼 클릭

#### 설정 관리
- 접미사 선택 후 "불러오기"
- 테이블에서 범위 수정 가능
- "💾 저장" 버튼으로 설정 저장
- "📂 열기"로 Excel 직접 편집

#### 마커 형식
Word 문서에 마커 삽입 예시:
```
GSM 850_#1
(마커접두사_접미사)
```

💡 **팁**:
- 접미사는 파일명에서 자동 추출
- 여러 파일 동시 처리 가능
- 이미지 크기 자동 조정

## 주요 수정 내역

### v1.0 (2026-02-12)
- ✅ QThread 가비지 컬렉션 문제 해결
- ✅ Qt 스레드 안전성 위반 수정 (_silent_mode 패턴)
- ✅ 에러 메시지 로깅 개선 (log_callback 패턴)
- ✅ 버튼 비활성화 로직 추가 (중복 실행 방지)
- ✅ 한글 주석 추가

## 라이선스

MIT License

## 작성자

kkulhong
